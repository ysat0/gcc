2006-03-26  David Daney  <ddaney@avtrex.com>

	* configure.ac: Remove checks for mktime, alloca, ioctl, gmtime_r,
	fork, execvp, execinfo.h, pthread_mutexattr_settype,
	pthread_mutexattr_setkind_np and sys/wait.h.
	* Makefile.in: Regenerate.
	* include/Makefile.in: Regenerate.
	* include/config.h.in: Regenerate.
	* testsuite/Makefile.in: Regenerate.
	* configure: Regenerate.
	* gcj/Makefile.in: Regenerate.

2007-03-23  Gary Benson  <gbenson@redhat.com>

	* link.cc (_Jv_Linker::resolve_method_entry):
	Ensure that the argument types and the return type of the
	found method match those expected by the calling method.

2007-03-22  David Daney  <ddaney@avtrex.com>

	PR libgcj/31228
	* configure.ac: Add checks for getrlimit and sys/resource.h.
	* include/posix.h (_Jv_platform_close_on_exec): Remove.
	* include/config.h.in: Regenerate.
	* configure: Regenerate.
	* gnu/java/nio/channels/natFileChannelPosix.cc (open): Remove call to
	_Jv_platform_close_on_exec;
	* gnu/java/net/natPlainSocketImplPosix.cc (create): Likewise.
	(accept): Likewise.
	* gnu/java/net/natPlainDatagramSocketImplPosix.cc (create):Likewise.
	* java/lang/natPosixProcess.cc: Include sys/resource.h.
	(nativeSpawn): Close all file descriptors.  Don't set FD_CLOEXEC on
	pipes.

2007-03-20  Andrew Haley  <aph@redhat.com>

	* testsuite/libjava.lang/PR31264.java: New test.

2007-03-14  Jakub Jelinek  <jakub@redhat.com>

	* Makefile.am (AM_MAKEFLAGS): Pass through mandir.
	* Makefile.in: Rebuilt.

2007-03-13  Keith Seitz  <keiths@redhat.com>

	* include/java-interp.h (_Jv_InterpClass): Declare
	friend function _Jv_GetInterpClassSourceFile.
	* java/lang/Class.h (Class): Likewise.
	* java/lang/natClass.cc (_Jv_GetInterpClassSourceFile):
	New function.
	* gnu/classpath/jdwp/natVMVirtualMachine.cc
	(getSourceFile): Implement.

2007-03-13  Thomas Fitzsimmons  <fitzsim@redhat.com>

	* Makefile.am (AM_CXXFLAGS): Define ECJ_JAR_FILE.
	* classpath/configure.ac: Add --with-ecj-jar configure option.
	* classpath/gnu/classpath/Configuration.java.in (ECJ_JAR): New
	field.
	* classpath/INSTALL: Document --with-ecj-jar configure option and
	ecj jar requirement for com.sun.tools.javac support.
	* classpath/tools/Makefile.am: Build decendents of com and sun
	directories.
	* configure.ac: Substitute ECJ_JAR in stub Configuration.java.
	* gnu/classpath/Configuration.java,
	gnu/classpath/natConfiguration.cc (ecj): New method.
	(ECJ_JAR): New field.
	* scripts/makemake.tcl (scan_packages): Add com directory.
	* sources.am (property_files): Add
	classpath/resource/sun/rmi/rmic/messages.properties and
	classpath/resource/com/sun/tools/javac/messages.properties.
	* classpath/resource/com, classpath/resource/com/sun,
	classpath/resource/com/sun/tools,
	classpath/resource/com/sun/tools/javac, classpath/resource/sun,
	classpath/resource/sun/rmi, classpath/resource/sun/rmi/rmic,
	classpath/tools/classes/com, classpath/tools/classes/com/sun,
	classpath/tools/classes/com/sun/javadoc,
	classpath/tools/classes/com/sun/tools,
	classpath/tools/classes/com/sun/tools/doclets,
	classpath/tools/classes/sun, classpath/tools/classes/sun/rmi,
	classpath/tools/classes/sun/rmi/rmic, classpath/tools/com,
	classpath/tools/com/sun, classpath/tools/com/sun/javadoc,
	classpath/tools/com/sun/tools,
	classpath/tools/com/sun/tools/doclets,
	classpath/tools/com/sun/tools/javac, classpath/tools/sun,
	classpath/tools/sun/rmi, classpath/tools/sun/rmi/rmic: New
	directories.
	* classpath/resource/com/sun/tools/javac/messages.properties,
	classpath/resource/sun/rmi/rmic/messages.properties,
	classpath/tools/classes/com/sun/javadoc/ClassDoc.class,
	classpath/tools/classes/com/sun/javadoc/ConstructorDoc.class,
	classpath/tools/classes/com/sun/javadoc/Doc.class,
	classpath/tools/classes/com/sun/javadoc/DocErrorReporter.class,
	classpath/tools/classes/com/sun/javadoc/Doclet.class,
	classpath/tools/classes/com/sun/javadoc/ExecutableMemberDoc.class,
	classpath/tools/classes/com/sun/javadoc/FieldDoc.class,
	classpath/tools/classes/com/sun/javadoc/MemberDoc.class,
	classpath/tools/classes/com/sun/javadoc/MethodDoc.class,
	classpath/tools/classes/com/sun/javadoc/PackageDoc.class,
	classpath/tools/classes/com/sun/javadoc/ParamTag.class,
	classpath/tools/classes/com/sun/javadoc/Parameter.class,
	classpath/tools/classes/com/sun/javadoc/ProgramElementDoc.class,
	classpath/tools/classes/com/sun/javadoc/RootDoc.class,
	classpath/tools/classes/com/sun/javadoc/SeeTag.class,
	classpath/tools/classes/com/sun/javadoc/SerialFieldTag.class,
	classpath/tools/classes/com/sun/javadoc/SourcePosition.class,
	classpath/tools/classes/com/sun/javadoc/Tag.class,
	classpath/tools/classes/com/sun/javadoc/ThrowsTag.class,
	classpath/tools/classes/com/sun/javadoc/Type.class,
	classpath/tools/classes/com/sun/javadoc/TypeVariable.class,
	classpath/tools/classes/com/sun/tools/doclets/Taglet.class,
	classpath/tools/classes/sun/rmi/rmic/Main.class,
	classpath/tools/classes/sun/rmi/rmic/Messages.class,
	classpath/tools/com/sun/javadoc/ClassDoc.java,
	classpath/tools/com/sun/javadoc/ConstructorDoc.java,
	classpath/tools/com/sun/javadoc/Doc.java,
	classpath/tools/com/sun/javadoc/DocErrorReporter.java,
	classpath/tools/com/sun/javadoc/Doclet.java,
	classpath/tools/com/sun/javadoc/ExecutableMemberDoc.java,
	classpath/tools/com/sun/javadoc/FieldDoc.java,
	classpath/tools/com/sun/javadoc/MemberDoc.java,
	classpath/tools/com/sun/javadoc/MethodDoc.java,
	classpath/tools/com/sun/javadoc/PackageDoc.java,
	classpath/tools/com/sun/javadoc/ParamTag.java,
	classpath/tools/com/sun/javadoc/Parameter.java,
	classpath/tools/com/sun/javadoc/ProgramElementDoc.java,
	classpath/tools/com/sun/javadoc/RootDoc.java,
	classpath/tools/com/sun/javadoc/SeeTag.java,
	classpath/tools/com/sun/javadoc/SerialFieldTag.java,
	classpath/tools/com/sun/javadoc/SourcePosition.java,
	classpath/tools/com/sun/javadoc/Tag.java,
	classpath/tools/com/sun/javadoc/ThrowsTag.java,
	classpath/tools/com/sun/javadoc/Type.java,
	classpath/tools/com/sun/javadoc/TypeVariable.java,
	classpath/tools/com/sun/tools/doclets/Taglet.java,
	classpath/tools/com/sun/tools/javac/Main.java,
	classpath/tools/com/sun/tools/javac/Messages.java,
	classpath/tools/sun/rmi/rmic/Main.java,
	classpath/tools/sun/rmi/rmic/Messages.java: New files.
	* Makefile.in, classpath/Makefile.in, classpath/configure,
	classpath/doc/Makefile.in, classpath/doc/api/Makefile.in,
	classpath/examples/Makefile.in, classpath/external/Makefile.in,
	classpath/external/jsr166/Makefile.in,
	classpath/external/relaxngDatatype/Makefile.in,
	classpath/external/sax/Makefile.in,
	classpath/external/w3c_dom/Makefile.in,
	classpath/include/Makefile.in, classpath/include/config.h.in,
	classpath/lib/Makefile.in,
	classpath/lib/gnu/classpath/Configuration.class,
	classpath/native/Makefile.in, classpath/native/fdlibm/Makefile.in,
	classpath/native/jawt/Makefile.in,
	classpath/native/jni/Makefile.in,
	classpath/native/jni/classpath/Makefile.in,
	classpath/native/jni/gconf-peer/Makefile.in,
	classpath/native/jni/gtk-peer/Makefile.in,
	classpath/native/jni/java-io/Makefile.in,
	classpath/native/jni/java-lang/Makefile.in,
	classpath/native/jni/java-net/Makefile.in,
	classpath/native/jni/java-nio/Makefile.in,
	classpath/native/jni/java-util/Makefile.in,
	classpath/native/jni/midi-alsa/Makefile.in,
	classpath/native/jni/midi-dssi/Makefile.in,
	classpath/native/jni/native-lib/Makefile.in,
	classpath/native/jni/qt-peer/Makefile.in,
	classpath/native/jni/xmlj/Makefile.in,
	classpath/native/plugin/Makefile.in,
	classpath/resource/Makefile.in, classpath/scripts/Makefile.in,
	classpath/tools/Makefile.in, configure,
	gnu/classpath/Configuration.h: Regenerate.

2007-03-12  Kyle Galloway  <kgallowa@redhat.com>

	* jvmti.cc (_Jv_JVMTI_GetArgumentsSize): Make wide type arrays count
	as a sigle slot.

2007-03-12  Marco Trudel  <mtrudel@gmx.ch>

	* java/lang/natString.cc (getBytes (jstring enc)):
	Fixed the loop for multiple cycles, Code cleanup

2007-03-09  Tom Tromey  <tromey@redhat.com>

	* sources.am, Makefile.in: Rebuilt.
	* scripts/makemake.tcl (scan_directory): Allow service files to be
	omitted.
	Omit all XML-related service files.

2007-03-07  Tom Tromey  <tromey@redhat.com>

	* configure: Rebuilt.
	* configure.ac: Clear vm-tools-packages.

2007-03-07  Mohan Embar  <gnustuff@thisiscool.com>

	* java/lang/Win32Process.java: Added nested class EOFInputStream.
	* java/lang/natWin32Process.cc (ChildProcessPipe): Added DUMMY
	enum and implementation.
	(startProcess): Use redirect flag.
	* classpath/lib/java/lang/Win32Process.class: Regenerated.
	* classpath/lib/java/lang/Win32Process$EOFInputStream.class: New.
	* gcj/javaprims.h: Regenerated.
	* java/lang/Win32Process$EOFInputStream.h: New.

2007-03-07  Andrew Haley  <aph@redhat.com>

	* libgcj_bc.c (JvRunMainName): Declare.

2007-03-07  Gary Benson  <gbenson@redhat.com>

	* sources.am, Makefile.in: Rebuilt.

2007-03-07  Mohan Embar  <gnustuff@thisiscool.com>

	* gcj/javaprims.h: Regenerated.

2007-03-07  Alexandre Oliva  <aoliva@redhat.com>

	* include/jvm.h (_Jv_ClosureListFinalizer): New.
	(_Jv_Linker::create_error_method): Adjust.
	* boehm.cc (_Jv_ClosureListFinalizer): New.
	* nogc.cc (_Jv_ClosureListFinalizer): New.
	* java/lang/Class.h (class _Jv_ClosureList): New.
	(class java::lang::Class): Declare it as friend.
	* java/lang/natClass.cc (_Jv_ClosureList::releaseClosures): New.
	(_Jv_ClosureList::registerClousure): New.
	* include/execution.h (_Jv_ExecutionEngine): Add get_closure_list.
	(_Jv_CompiledEngine::do_get_closure_list): New.
	(_Jv_CompiledEngine::_Jv_CompiledEngine): Use it.
	(_Jv_IndirectCompiledClass): Add closures.
	(_Jv_IndirectCompiledEngine::get_aux_info): New.
	(_Jv_IndirectCompiledEngine::do_allocate_field_initializers): Use
	it.
	(_Jv_IndirectCompiledEngine::do_get_closure_list): New.
	(_Jv_IndirectCompiledEngine::_Jv_IndirectCompiledEngine): Use it.
	(_Jv_InterpreterEngine::do_get_closure_list): Declare.
	(_Jv_InterpreterEngine::_Jv_InterpreterEngine): Use it.
	* interpret.cc (FFI_PREP_RAW_CLOSURE): Use _loc variants.
	(node_closure): Add closure list.
	(_Jv_InterpMethod::ncode): Add jclass argument.  Use
	ffi_closure_alloc and the separate code pointer.  Register the
	closure for finalization.
	(_Jv_JNIMethod::ncode): Likewise.
	(_Jv_InterpreterEngine::do_create_ncode): Pass klass to ncode.
	(_Jv_InterpreterEngine::do_get_closure_list): New.
	* include/java-interp.h (_Jv_InterpMethod::ncode): Adjust.
	(_Jv_InterpClass): Add closures field.
	(_Jv_JNIMethod::ncode): Adjust.
	* defineclass.cc (_Jv_ClassReader::handleCodeAttribute): Adjust.
	(_Jv_ClassReader::handleMethodsEnd): Likewise.
	* link.cc (struct method_closure): Add closure list.
	(_Jv_Linker::create_error_method): Add jclass argument.  Use
	ffi_closure_alloc and the separate code pointer.  Register the
	closure for finalization.
	(_Jv_Linker::link_symbol_table): Remove outdated comment about
	sharing of otable and atable.  Adjust.
	* java/lang/reflect/natVMProxy.cc (ncode_closure): Add closure
	list.
	(ncode): Add jclass argument.  Use ffi_closure_alloc and the
	separate code pointer.  Register the closure for finalization.
	(java::lang::reflect::VMProxy::generateProxyClass): Adjust.
	* testsuite/libjava.jar/TestClosureGC.java: New.
	* testsuite/libjava.jar/TestClosureGC.out: New.
	* testsuite/libjava.jar/TestClosureGC.xfail: New.
	* testsuite/libjava.jar/TestClosureGC.jar: New.

2007-03-06  Kyle Galloway  <kgallowa@redhat.com>

	* classpath/gnu/classpath/jdwp/exception/AbsentInformationException.java: New file.
	* classpath/lib/gnu/classpath/jdwp/exception/AbsentInformationException.class: Ditto.
	* gnu/classpath/jdwp/exception/AbsentInformationException.h: Ditto.
	* gnu/classpath/jdwp/natVMMethod.cc: Add CHECK_INTERP_CLASS macro.
	(VMMethod::getLineTable): Use new macro.
	(VMMethod::getVariableTable): Implement.
	* sources.am: Regenerated.
	* Makefile.in: Ditto.

2007-03-06  Tom Tromey  <tromey@redhat.com>

	* Makefile.in: Rebuilt.
	* Makefile.am (bin_PROGRAMS): Added gcjh.
	(gcjh_SOURCES, gcjh_LDFLAGS, gcjh_LINK, gcjh_LDADD,
	gcjh_DEPENDENCIES): New variables.

2007-03-06  Kyle Galloway  <kgallowa@redhat.com>

	* jvmti.cc(_Jv_JVMTI_GetLocalVariableTable): Fix _Jv_Malloc parameters.
	* testsuite/libjava.jvmti/interp/natgetlocalvartable.cc
	(do_getlocalvartable_tests): Add Deallocate calls to free strings.

2007-03-05  Matthias Klose  <doko@debian.org>

	* Makefile.am (gij_LDFLAGS): Use dbexecdir.
	* Makefile.in: Regnerate.

2007-03-05  Mark Wielaard  <mark@klomp.org>

	* java/lang/Character.java: Re-merged with Classpath.
	* java/lang/natString.cc (nativeCompareTo): Renamed from
	compareTo.
	* java/lang/StringBuilder.java: Re-merged with Classpath.
	* java/lang/String.java: Re-merged with Classpath.
	(nativeCompareTo): Renamed from compareTo.
	* java/lang/StringBuffer.java: Re-merged with Classpath.
	* jni.cc (_Jv_JNI_GetAnyMethodID): Split calls to append.

2007-03-05  Andrew Haley  <aph@redhat.com>

	* java/lang/reflect/natVMProxy.cc (ncode_closure.meth): Delete.
	(generateProxyClass): Don't pass method to ncode.
	(run_proxy): Call _Jv_GetReflectedMethod to find the proxy method.
	* java/lang/reflect/Method.h: Rebuild.
	* java/lang/reflect/Method.java (internalGetParameterTypes,
	internalGetExceptionTypes): New methods.
	* headers.txt (class java/lang/reflect/Method): Declare
	_Jv_GetReflectedMethod.  Be its friend.
	* java/lang/natClass.cc (_Jv_GetReflectedMethod): New method.
	* java/lang/Class.h: Declare it.  Be its friend.

2007-03-05  Tom Tromey  <tromey@redhat.com>

	* sources.am, Makefile.in: Rebuilt.
	* scripts/makemake.tcl (emit_package_rule): Don't omit
	VMProcess.java.
	* Makefile.am (nat_source_files): Added natVMProcess.cc.
	(inner_nat_headers): Added ImmediateEOFInputStream.h.
	* gcj/javaprims.h: Regenerated.
	* java/lang/System.java (EnvironmentMap): Now package-private.
	(EnvironmentMap(Map)): New constructor.
	(EnvironmentMap.put): New method.
	* java/lang/natWin32Process.cc (startProcess): Update.
	* java/lang/Win32Process.java (Win32Process): Added 'redirect'
	argument.
	(startProcess): Likewise.
	* java/lang/EcosProcess.java (EcosProcess): Added 'redirect'
	argument.
	* java/lang/natPosixProcess.cc (nativeSpawn): Handle redirection.
	* java/lang/PosixProcess.java (redirect): New field.
	(PosixProcess): Added 'redirect' argument.
	* java/lang/natRuntime.cc (execInternal): Added 'redirect'
	argument to Process creation.
	* java/lang/natVMProcess.cc: New file.
	* java/lang/ProcessBuilder.java: Removed.
	* java/lang/VMProcess.java: New file.

2007-03-03  Andrew Haley  <aph@redhat.com>

	* java/lang/natClass.cc (parseAnnotationElement): Correct long
	annotations to read JV_CONSTANT_Long, not JV_CONSTANT_Double.

2007-03-02  Andrew Haley  <aph@redhat.com>

	* sun/reflect/annotation/AnnotationInvocationHandler.java:
	Generify in a few places.
	(equals): Rewrite to use invoke on local proxy.
	(deepToString): Remove most of it.
	(toString): Make nonstatic.
	(arrayClone): Delete.
	(coerce): New method.
	(invoke): Rewrite to handle gcj's structures correctly.
	* java/lang/natClass.cc (getDeclaredAnnotations): Fix test for
	null loader.
	* sources.am: Regenerate.
	* Makefile.am: Likewise.	

2007-03-02  Andrew Haley  <aph@redhat.com>

	* sun/reflect/annotation/AnnotationInvocationHandler.java:
	Whitespace only changes.

2007-03-02  Andrew Haley  <aph@redhat.com>

	* sun/reflect/annotation/AnnotationInvocationHandler.java: Moved
	from Classpath to libgcj local.

2007-03-01  Brooks Moses  <brooks.moses@codesourcery.com>

	* Makefile.am: Add dummy install-pdf target.
	* Makefile.in: Regenerate
	* include/Makefile.in: Regenerate
	* testsuite/Makefile.in: Regenerate
	* gcj/Makefile.in: Regenerate

2007-02-23  Gary Benson  <gbenson@redhat.com>

	* gnu/gcj/tools/gcj_dbtool/Main.java: Updated copyright year.

2007-02-23  Gary Benson  <gbenson@redhat.com>

	* java/lang/VMCompiler.java
	(compileClass): Don't lose zeros from within the digest.

2007-02-22  Jakub Jelinek  <jakub@redhat.com>

	PR libgcj/17002
	PR classpath/28550
	* java/util/VMTimeZone.java (getDefaultTimeZoneId): To read
	/etc/localtime, use ZoneInfo.readTZFile instead of
	VMTimeZone.readtzFile.  Get better timezone name for /etc/localtime,
	either if it is a symlink or through /etc/sysconfig/clock.
	(readSysconfigClockFile): New static method.
	(readtzFile): Removed.
	* java/lang/System.java: Add gnu.java.util.zoneinfo.dir to comments.
	* posix.cc (_Jv_platform_initProperties): Set
	gnu.java.util.zoneinfo.dir.
	* sources.am (gnu_java_util_source_files): Add
	classpath/gnu/java/util/ZoneInfo.java.
	* Makefile.in: Regenerated.
	* java/util/VMTimeZone.h: Regenerated.
	* java/util/TimeZone.h: Regenerated.
	* gnu/java/util/ZoneInfo.h: Generated.

2007-02-22  Mohan Embar  <gnustuff@thisiscool.com>

	* include/win32-threads.h: Added #undef OUT.

2007-02-21  Kyle Galloway  <kgallowa@redhat.com>

	* jvmti.cc (_Jv_JVMTI_GetArgumentsSize): New function.
	* testsuite/libjava.jvmti/interp/getargssize.java: New test.
	* testsuite/libjava.jvmti/interp/getargssize.h: Ditto.
	* testsuite/libjava.jvmti/interp/getargssize.jar: Ditto.
	* testsuite/libjava.jvmti/interp/getargssize.out: Ditto.
	* testsuite/libjava.jvmti/interp/natgetargssize.cc: Ditto.

2007-02-21  Gary Benson  <gbenson@redhat.com>

	* java/util/GregorianCalendar.java: Removed.
	* sources.am, Makefile.in: Rebuilt.

2007-02-20  Keith Seitz  <keiths@redhat.com>

	* gnu/classpath/jdwp/natVMVirtualMachine.cc
	(jdwpClassPrepareCB): Move class status stuff to ...
	(getClassStatus): ... here.

2007-02-20  Gary Benson  <gbenson@redhat.com>

	* gnu/awt/xlib/XEventLoop.h: Regenerated.
	* gnu/java/awt/peer/gtk/GThreadMutex.h: Likewise.
	* gnu/java/rmi/server/ConnectionRunnerPool$ConnectionRunner.h:
	Likewise.
	* gnu/java/rmi/server/UnicastConnectionManager.h: Likewise.
	* java/lang/SecurityManager.h: Likewise.
	* java/lang/Thread.h: Likewise.
	* java/security/VMSecureRandom$Spinner.h: Likewise.
	* java/util/concurrent/atomic/AtomicBoolean.h: Likewise.
	* java/util/concurrent/atomic/AtomicInteger.h: Likewise.
	* java/util/concurrent/atomic/AtomicLong.h: Likewise.
	* java/util/concurrent/atomic/AtomicReference.h: Likewise.
	* java/util/concurrent/ConcurrentHashMap$HashEntry.h: Likewise.
	* java/util/concurrent/ConcurrentHashMap$Segment.h: Likewise.
	* java/util/concurrent/ConcurrentLinkedQueue.h: Likewise.
	* java/util/concurrent/ConcurrentLinkedQueue$Node.h: Likewise.
	* java/util/concurrent/ConcurrentSkipListMap.h: Likewise.
	* java/util/concurrent/ConcurrentSkipListMap$Index.h: Likewise.
	* java/util/concurrent/ConcurrentSkipListMap$Node.h: Likewise.
	* java/util/concurrent/Exchanger.h: Likewise.
	* java/util/concurrent/Exchanger$Node.h: Likewise.
	* java/util/concurrent/FutureTask$Sync.h: Likewise.
	* java/util/concurrent/LinkedBlockingQueue$Node.h: Likewise.
	* java/util/concurrent/locks/AbstractQueuedLongSynchronizer.h:
	Likewise.
	* java/util/concurrent/locks/AbstractQueuedLongSynchronizer$Node.h: 
	Likewise.
	* java/util/concurrent/locks/AbstractQueuedSynchronizer.h: Likewise.
	* java/util/concurrent/locks/AbstractQueuedSynchronizer$Node.h:
	Likewise.
	* java/util/concurrent/ScheduledThreadPoolExecutor.h: Likewise.
	* java/util/concurrent/SynchronousQueue.h: Likewise.
	* java/util/concurrent/SynchronousQueue$TransferQueue.h: Likewise.
	* java/util/concurrent/SynchronousQueue$TransferQueue$QNode.h:
	Likewise.
	* java/util/concurrent/SynchronousQueue$TransferStack.h: Likewise.
	* java/util/concurrent/SynchronousQueue$TransferStack$SNode.h:
	Likewise.
	* java/util/concurrent/ThreadPoolExecutor.h: Likewise.
	* java/util/concurrent/ThreadPoolExecutor$Worker.h: Likewise.
	* java/util/logging/ErrorManager.h: Likewise.
	* javax/swing/plaf/basic/BasicSpinnerUI$2.h: Likewise.
	* javax/swing/plaf/basic/BasicSpinnerUI$4.h: Likewise.

2007-02-16  Keith Seitz  <keiths@redhat.com>

	* gnu/classpath/jdwp/natVMVirtualMachine.cc
	(get_line_table): New function.
	(handle_single_step): New function.
	(jdwpSingleStepCB): New function.
	(jdwpVMInitCB): Define a JVMTI single step
	callback, but don't enable it until needed.

2007-02-16  David Daney  <ddaney@avtrex.com>

	* java/lang/Thread.java (Thread(ThreadGroup, Runnable, String)): Pass
	new parameter constructor.
	(Thread(ThreadGroup, Runnable, String, long)): Same.
	(Thread(String, boolean)): New constructor.
	(Thread(Thread, ThreadGroup, Runnable, String): Add parameter
	noInheritableThreadLocal, don't call
	InheritableThreadLocal.newChildThread if set.
	* java/lang/PosixProcess.java(ProcessManager()): Set
	noInheritableThreadLocal in super.
	* java/lang/natThread.cc (_Jv_AttachCurrentThread): Pass new
	parameter to Thread constructor.
	(_Jv_AttachCurrentThreadAsDaemon): Same.
	* java/lang/Thread.h: Regenerate.
	* classpath/lib/java/lang/Thread.class: Same.
	* classpath/lib/java/lang/PosixProcess$EOFInputStream.class: Same.
	* classpath/lib/java/lang/PosixProcess.class: Same.
	* classpath/lib/java/lang/Thread$State.class: Same.
	* classpath/lib/java/lang/PosixProcess$ProcessManager.class: Same.

2007-02-16  Kyle Galloway  <kgallowa@redhat.com>

	* interpret.cc: Add extra DEBUG_LOCALS_INSN calls for multi-slot
	variables to maintain type info.
	* interpret-run.cc: Add local variable info to frame in the debug
	interpreter.
	* jvmti.cc (getLocalFrame): New method.
	(_Jv_JVMTI_GetLocalObject): New method.
	(_Jv_JVMTI_GetLocallInt): New method.
	(_Jv_JVMTI_GetLocalFloat): New method.
	(_Jv_JVMTI_GetLocalLong): New method.
	(_Jv_JVMTI_GetLocalDouble): New method.
	(_Jv_JVMTI_SetLocalObject): New method.
	(_Jv_JVMTI_SetLocalInt): New method.
	(_Jv_JVMTI_SetLocalFloat): New method.
	(_Jv_JVMTI_SetLocalLong): New method.
	(_Jv_JVMTI_SetLocalDouble): New method.

2007-02-16  Gary Benson  <gbenson@redhat.com>

	* gnu/gcj/tools/gcj_dbtool/Main.java
	(bytesToString): Don't lose zeros from within the digest.

2007-02-15  Andrew Haley  <aph@redhat.com>

	* Makefile.am (nat_source_files): Remove
	java/lang/management/natVMManagementFactory.cc.
	* java/lang/Thread.java (getStackTrace): Use reflection to call
	the ManagementFactory.
	* java/lang/management/VMManagementFactory.java: Remove native
	methods.
	* java/lang/management/natVMManagementFactory.cc: Deleted.
	* sources.am: Regnerate.
	* scripts/makemake.tcl: Add new "bcheaders" type.
	Move java/lang/management and gnu/classpath/management to "bc".
	Move gnu/java/lang/management to "bcheaders".
	
2007-02-15  Kyle Galloway  <kgallowa@redhat.com>
	
	* interpret.cc (_Jv_InterpMethod::check_handler): New method.
	* interpret-run.cc: Change the catch section to report exception
	events and to use the new check_handler method.
	* include/java-interp.h (_Jv_InterpMethod): Add check_handler.
	* gnu/gcj/jvmti/ExceptionEvent.java: New file.
	* gnu/gcj/jvmti/ExceptionEvent.h: New file.
	* gnu/gcj/jvmti/natExceptionEvent.cc: New file.
	* libjava/classpath/lib/gnu/gcj/jvmti/ExceptionEvent.class: New
	file.
	* sources.am: Added ExceptionEvent.java.
	* Makefile.am: Added natExceptionEvent.cc
	* Makefile.in: Regenerated.
	* include/Makefile.in: Regenerated.
	* gcj/Makefile.in: Regenerated.

2007-02-15  Johannes Schmidt  <jschmidt@avtrex.com>
	David Daney  <ddaney@avtrex.com>

	* configure.ac: Create vm-tools-packages file.  Add 
	gnu/gcj/tools/gc_analyze to standard.omit and vm-tools-packages.
	Check for /proc/self/maps.
	* Makefile.am (bin_PROGRAMS): Added gc-analyze.
	(gc_analyze_SOURCES): New.
	(gc_analyze_LDFLAGS): New.
	(gc_analyze_LINK): New.
	(gc_analyze_LDADD): New.
	(gc_analyze_DEPENDENCIES): New.
	(nat_source_files): Add gnu/gcj/util/natGCInfo.cc.
	* Makefile.in: Regenerated.
	* configure: Regenerated.
	* include/config.h.in: Regenerated.
	* sources.am: Regenerated.
	* scripts/makemake.tcl: Don't include gc-analyze classes in libgcj.
	* gnu/gcj/tools/gc_analyze/SymbolLookup.java: New.
	* gnu/gcj/tools/gc_analyze/ObjectMap.java: New.
	* gnu/gcj/tools/gc_analyze/MemoryMap.java: New.
	* gnu/gcj/tools/gc_analyze/SymbolTable.java: New.
	* gnu/gcj/tools/gc_analyze/BlockMap.java: New.
	* gnu/gcj/tools/gc_analyze/BytePtr.java: New.
	* gnu/gcj/tools/gc_analyze/ItemList.java: New.
	* gnu/gcj/tools/gc_analyze/ToolPrefix.java: New.
	* gnu/gcj/tools/gc_analyze/MemoryAnalyze.java: New.
	* gnu/gcj/util/GCInfo.java: New.
	* gnu/gcj/util/GCInfo.h: New.
	* gnu/gcj/util/natGCInfo.cc: New.
	* gnu/gcj/util/UtilPermission.java: New.
	* gnu/gcj/util/UtilPermission.h: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/SymbolTable.class: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/ObjectMap$ObjectItem.class: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/MemoryMap$RangeComparator.class: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/BlockMap$PtrMarks.class: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/MemoryMap$Range.class: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/BlockMap.class: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/BytePtr.class: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/MemoryAnalyze$SubstringComparator.class: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/ItemList.class: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/ToolPrefix.class: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/MemoryAnalyze.class: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/MemoryAnalyze$1$Info.class: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/MemoryAnalyze$1.class: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/MemoryAnalyze$2.class: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/MemoryAnalyze$3.class: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/MemoryAnalyze$4.class: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/MemoryAnalyze$OptionParser.class: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/BlockMap$SizeKind.class: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/SymbolLookup.class: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/ObjectMap.class: New.
	* classpath/tools/gnu/gcj/tools/gc_analyze/MemoryMap.class: New.
	* classpath/lib/gnu/gcj/util/GCInfo.class: New.
	* classpath/lib/gnu/gcj/util/UtilPermission.class: New.

2007-02-15  David Daney  <ddaney@avtrex.com>

	* gnu/java/net/PlainSocketImpl.h: Regenerate.
	* gnu/classpath/jdwp/VMVirtualMachine.h: Same.
	* gnu/classpath/jdwp/VMFrame.h: Same.
	* java/net/Socket.h: Same.
	* java/util/Collections$UnmodifiableMap$UnmodifiableEntrySet.h: Same.

2007-02-15  Kyle Galloway  <kgallowa@redhat.com>

	* defineclass.cc (_Jv_ClassReader::read_one_code_attribute):
	Added LocalVariableTable attribute handling.
	(_Jv_ClassReader::pool_Utf8_to_char_arr): New method.
	* jvmti.cc (_Jv_JVMTI_GetLocalVariableTable): New method.
	* include/java-interp.h: Added local_var_table and 
	local_var_table_len fields to _Jv_InterpMethod.
	(_Jv_InterpMethod::get_local_var_table): New method.
	* testsuite/libjava.jvmti/interp/getlocalvartable.java: New test.
	* testsuite/libjava.jvmti/interp/getlocalvartable.jar: New test.
	* testsuite/libjava.jvmti/interp/getlocalvartable.out: Output
	for new test.
	* testsuite/libjava.jvmti/interp/getlocalvartable.h: New test.
	* testsuite/libjava.jvmti/interp/natgetlocalvartable.cc: New test.

2007-02-15  Kyle Galloway  <kgallowa@redhat.com>

	* gnu/classpath/jdwp/natVMVirtualMachine (getFrames): Implement.

2007-02-13  Keith Seitz  <keiths@redhat.com>

	* gnu/classpath/jdwp/natVMVirtualMachine.cc
	(jdwpBreakpointCB): New function.
	(jdwpVMInitCB): Define and enable the breakpoint
	callback.

2007-02-13  Andrew Haley  <aph@redhat.com>

	* testsuite/libjava.lang/Divide_2.out
	* testsuite/libjava.lang/Divide_2.java: New test.

2007-02-12  Keith Seitz  <keiths@redhat.com>

	* jvmti.cc (_Jv_JVMTI_GetStackTrace): Remove cast
	from jthread to Thread *; it is no longer needed.
	(_Jv_JVMTI_GetFrameCount): Likewise.
	Fix small formatting typo.

2007-02-12  Tom Tromey  <tromey@redhat.com>

	* sources.am, Makefile.in: Rebuilt.
	* java/lang/Socket.java: Removed override.
	* java/lang/DatagramSocket.java: Removed override.
	* gnu/java/net/PlainSocketImpl.java (localSocketAddress): New
	field.
	(getLocalAddress): New method.
	* gnu/java/net/PlainDatagramSocketImpl.java
	(PlainDatagramSocketImpl): Throws IOException.
	* gnu/java/net/natPlainSocketImplPosix.cc (write): Remove
	'sizeof'.
	(read): Likewise.

2007-02-09  Jakub Jelinek  <jakub@redhat.com>

	* java/util/VMTimeZone.java: Rewrite to handle both the old
	'TZif\0' format and the new one.
	
2007-02-10  Andrew Haley  <aph@redhat.com>

	PR java/30742
	* gnu/classpath/natVMStackWalker.cc (GET_CALLING_CLASS): New.
	(getCallingClass): Call GET_CALLING_CLASS.
	(getCallingClassLoader): Likewise.

2007-02-10  Mohan Embar  <gnustuff@thisiscool.com>

	* configure: Rebuilt.
	* configure.ac (GCJH): Reverted second part of patch of 2006-12-20.

2007-02-10  Mohan Embar  <gnustuff@thisiscool.com>

	* Makefile.in: Rebuilt.
	* Makefile.am (BUILD_ECJ1): Unify the command for renaming ecjx to
	the host's ecj1 executable.

2007-02-09  Richard Henderson  <rth@redhat.com>

	* sysdep/alpha/locks.h (read_barrier): New.

2007-02-09  Keith Seitz  <keiths@redhat.com>

	* gnu/classpath/jdwp/VMVirtualMachine.java
	(_stepping_threads): New member.
	* classpath/lib/gnu/classpath/jdwp/VMVirtualMachine.class:
	Regenerated.
	* gnu/classpath/jdwp/VMVirtualMachine.h:
	Regenerated.
	* gnu/claspath/jdwp/natVMVirtualMachine.cc
	(get_request_step_filter): New function.
	(DISABLE_EVENT): New macro.
	(initialize): Initialize _stepping_threads.
	(registerEvent): Implement EVENT_SINGLE_STEP.
	(unregisterEvent): Likewise.

2007-02-08  Keith Seitz  <keiths@redhat.com>

	* sources.am: Regenerate.
	* Makefile.in: Regenerate.
	* testsuite/Makefile.in: Regenerate.
	* gcj/Makefile.in: Regenerate.
	* include/Makefile.in: Regenerate.

	* classpath/lib/javax/management/MBeanServerFactory.class:
	Regenerate.

2007-02-08  Kyle Galloway  <kgallowa@redhat.com>

	* classpath/gnu/classpath/jdwp/processor/
	StackFrameCommandSet.java (executeGetValues): Pass jlong instead
	of ByteBuffer.
	(executeSetValues): Ditto.
	(executeThisObject): Ditto.
	* classpath/gnu/classpath/jdwp/processor/
	StackFrameCommandSet.class: Rebuilt.
	* classpath/lib/gnu/classpath/jdwp/VMVirtualMachine.class:
	Rebuilt.
	* classpath/lib/gnu/classpath/jdwp/VMFrame.class: Rebuilt.
	* classpath/lib/gnu/classpath/jdwp/exception/
	InvalidFrameException.java: New file.
	* gnu/classpath/jdwp/VMFrame.java: Added field for thread of
	frame.
	(Constructor): New method.
	* gnu/classpath/jdwp/VMFrame.h: Regenerated.
	* gnu/classpath/jdwp/VMVirtualMachine.java
	(getFrame): Changed ByteBuffer to jlong.
	* gnu/classpath/jdwp/natVMVirtualMachine.cc
	(getFrame): Implement.
	* gnu/classpath/jdwp/VMVirtualMachine.h: Regenerated.

2007-02-08  Kyle Galloway  <kgallowa@redhat.com>

	* include/java-interp.h (_Jv_InterpFrame): obj_ptr field added
	to hold "this" pointer for frame.
	(_Jv_InterpFrame::get_this_ptr): New method.
	* interpret-run.cc: Copy the "this" pointer into obj_ptr.

2007-02-07  Keith Seitz  <keiths@redhat.com>

	* include/java-interp.h (_Jv_Frame::depth):
	New function.
	* jvmti.cc (_Jv_JVMTI_GetFrameCount): Use _Jv_Frame::depth.

2007-02-07  Kyle Galloway  <kgallowa@redhat.com>

	* jvmti.cc (CHECK_FOR_NATIVE_METHOD): New macro.
	(_Jv_JVMTI_GetMaxLocals): New method.
	* include/java-interp.h
	(_Jv_InterpMethod::get_max_locals): New method.

2007-02-01 Marco Trudel <mtrudel@gmx.ch>

	* jni.cc (_Jv_JNI_DeleteWeakGlobalRef): Check for NULL objects.

2007-02-07  Tom Tromey  <tromey@redhat.com>

	* testsuite/libjava.jni/init.c: New file.
	* testsuite/libjava.jni/init.java: New file.
	* testsuite/libjava.jni/init.out: New file.
	* testsuite/libjava.jni/init.jar: New file.
	* testsuite/libjava.jni/init.h: New file.
	* testsuite/libjava.jni/init$NativeClass.h: New file.

2007-02-07  Jakub Jelinek  <jakub@redhat.com>

	PR libgomp/28468
	* configure: Regenerate.

2007-02-06  Andrew Haley  <aph@redhat.com>

	* scripts/makemake.tcl (emit_bc_rule): Set the source filename.
	* sources.am: Rebuild.

2007-02-05  Keith Seitz  <keiths@redhat.com>

	* jvmti.cc (_envListLock): Change type to
	ReentrantReadWriteLock.
	(_Jv_JVMTI_DisposeEnvironment): Switch to read/write
	lock.
	(check_enabled_event): Likewise.
	(_Jv_GetJVMTIEnv): Likewise.
	(_Jv_JVMTI_Init): Likewise.
	(_Jv_JVMTI_PostEvent): Likewise. 

2007-02-05  Keith Seitz  <keiths@redhat.com>

	* gnu/classpath/jdwp/natVMVirtualMachine.cc
	(registerEvent): Implement EVENT_BREAKPOINT.
	(unregisterEvent): Likewise.
	(get_request_location): New function.

2007-02-05  Matthias Klose  <doko@debian.org>

	testsuite/Makefile.am (compile-tests): Fix typo.
	testsuite/Makefile.in: Regenerate.

2007-02-02  Kyle Galloway  <kgallowa@redhat.com>

	* gnu/classpath/jdwp/natVMVirtualMachine.cc (getFrameCount):
	Implment.

2007-02-02  Jakub Jelinek  <jakub@redhat.com>

	* configure.ac (libjava_cv_anon_version_script): New test.
	(ANONVERSCRIPT): New AM_CONDITIONAL.
	* configure: Rebuilt.
	* Makefile.am (extra_ldflags_libjava): Link with -Wl,--version-script
	if ANONVERSCRIPT.
	* Makefile.in: Rebuilt.
	(libgcj_la_DEPENDENCIES): Depend on libgcj.ver.
	* libgcj.ver: New file.

2007-02-01  David Daney  <ddaney@avtrex.com>

	* scripts/makemake.tcl: Replace gnu/xml build with build of all
	its subpackages.
	* sources.am: Regenerate.
	* Makefile.in: Regenerate.

2007-02-01  Tom Tromey  <tromey@redhat.com>

	* java/lang/ClassLoader.java (getResources): No longer final.

2007-02-01  Tom Tromey  <tromey@redhat.com>

	* java/util/logging/LogManager.java (loggers): Genericized.
	(addLogger): Merged.
	(findAncestor): Likewise.
	(getLogger): Likewise.
	(getLoggerNames): Genericized.
	(reset): Merged.
	(getLevelProperty): Likewise.
	* java/lang/reflect/Method.java (getDeclaringClass): Genericized.
	* java/lang/reflect/Constructor.java (getParameterTypes):
	Genericized.
	(getExceptionTypes): Likewise.
	(newInstance): Likewise.
	* java/lang/reflect/Array.java (newInstance): Genericized.
	* java/lang/Object.java (getClass): Genericized.
	* java/nio/charset/spi/CharsetProvider.java (charsets):
	Genericized.
	* java/text/Collator.java: Implement Comparable<Object>.

2007-02-01  Tom Tromey  <tromey@redhat.com>

	* java/util/Calendar.java: Implement Comparable<Calendar>.  Update
	comments.
	(clear): Call complete.
	(setTimeZone): Call computeTime, computeFields.
	(compareTo): New method.
	* java/nio/charset/Charset.java: Implement Comparable<Charset>.
	(availableCharsets): Genericized.
	(aliases): Likewise.
	(compareTo): Changed argument type.
	* java/lang/ClassLoader.java (loadClass): Genericized.
	(findClass): Likewise.
	(defineClass): Likewise.
	(resolveClass): Likewise.
	(findSystemClass): Likewise.
	(setSigners): Likewise.
	(findLoadedClass): Likewise.
	(getResources): Likewise.
	(findResources): Likewise.
	(getSystemResources): Likewise.
	(checkInitialized): New method.
	* java/lang/Class.java (getCanonicalName): New method.

2007-01-31  Keith Seitz  <keiths@redhat.com>

	* include/jvmti-int.h (JVMTI): Declare member "enabled".
	* jvmti.cc (JVMTI): Add member "enabled".
	(_Jv_GetJVMTIEnv): Mark JVMTI enabled.
	* interpret.cc (_Jv_InterpMethod::ncode): Use JVMTI::enabled
	instead of gnu::classpath::jdwp::Jdwp::isDebugging.
	(_Jv_CompileMethod): If JVMTI is enabled, use run_debug
	instead of run to compile the method.

	* interpret-run.cc [DEBUG] (NEXT_INSN): Add JVMTI single step
	notification.

2007-01-31  Andreas Tobler  <a.tobler@schweiz.org>

	* testsuite/libjava.jvmti/jvmti-interp.exp (gij_jvmti_test_one): Add
	-shared-libgcc to the cxxflaglist for Darwin.

2007-01-31  Tom Tromey  <tromey@redhat.com>

	* scripts.am, Makefile.in: Rebuilt.
	* scripts/makemake.tcl (gnu/javax/swing/text/html/parser): Build
	as 'ordinary'.
	(emit_ordinary_rule): New proc.

2007-01-31  Keith Seitz  <keiths@redhat.com>

	* testsuite/libjava.jvmti/getmethodname.h: New file.
	* testsuite/libjava.jvmti/getmethodname.jar: New file.

2007-01-31  Andrew Haley  <aph@redhat.com>

	* prims.cc (_Jv_Abort): fflush (stderr).
	* java/lang/natClassLoader.cc (_Jv_CheckABIVersion): Abort.

2007-01-31  Tom Tromey  <tromey@redhat.com>

	* configure, Makefile.in: Rebuilt.
	* configure.ac (JAR): Check for -@ feature.
	* Makefile.am (libgcj-$(gcc_version).jar): Use find -prune.

2007-01-31  Tom Tromey  <tromey@redhat.com>

	PR libgcj/30606:
	* configure, include/config.h.in: Rebuilt.
	* configure.ac: Check for magic_t in magic.h.
	* java/net/natVMURLConnection.cc: Use HAVE_MAGIC_T.

2007-01-30  Tom Tromey  <tromey@redhat.com>

	* Makefile.in: Rebuilt.
	* Makefile.am (libgcj-$(gcc_version).jar): Rewrote.

2007-01-30  Andreas Tobler  <a.tobler@schweiz.org>

	* testsuite/libjava.jvmti/natevents.cc (FieldModificationCB): Use a
	cast to print it right.

2007-01-29  Kaloian Doganov  <kaloian@doganov.org>

	PR libgcj/30600:
	* gnu/gcj/convert/BytesToCharsetAdaptor.java (read): Fix call to
	'limit'.

2007-01-29  Kyle Galloway  <kgallowa@redhat.com>

	* include/java-interp.h:  Added _Jv_Frame class and its two
	subclasses _Jv_InterpFrame and _Jv_NativeFrame.  Also moved
	_Jv_FrameType from java-stack.h.
	* include/java-stack.h: Removed _Jv_FrameType.
	* java/lang/Thread.java: Added frame member to hold new
	composite frame stack.
	* java/lang/Thread.h: Regenerated.
	* java/lang/Thread.class: Rebuilt.
	* jni.cc (_Jv_JNIMethod::call): Push a frame onto the stack when
	calling a JNI method.
	* jvmti.cc (_Jv_JVMTI_GetStackTrace): New Method.
	(_Jv_JVMTI_GetFrameCount): New method.
	* stacktrace.cc (UnwindTraceFn): Modified to use new _Jv_Frame
	classes.
	* testsuite/libjava.jvmti/interp/getstacktrace.jar: New test.
	* testsuite/libjava.jvmti/interp/natgetstacktrace.cc: New test.
	* testsuite/libjava.jvmti/interp/getstacktrace.h: New test.
	* testsuite/libjava.jvmti/interp/getstacktrace.jar: New test.
	* testsuite/libjava.jvmti/interp/getstacktrace.out: Output file
	for test. 

2007-01-29  Tom Tromey  <tromey@redhat.com>

	* interpret.cc (run_debug): Remove comment.
	(STOREA): Reformat.
	(STOREI): Likewise.
	(STOREF): Likewise.
	(STOREL): Likewise.
	(STORED): Likewise.
	(POKEI): Likewise.
	(run_normal_debug): Likewise.
	(run_synch_object_debug): Likewise.
	(run_class_debug): Likewise.
	(run_synch_class_debug): Likewise.
	(get1s): Likewise.
	(get1u): Likewise.
	(get2u): Likewise.
	(get4): Likewise.
	(NULLARRAYCHECK): Likewise.
	(ARRAYBOUNDSCHECK): Likewise.
	* interpret-run.cc (insn_target) <breakpoint>: Tidy.

2007-01-29  Tom Tromey  <tromey@redhat.com>

	* configure, Makefile.in: Rebuilt.
	* Makefile.am (bin_SCRIPTS): Never install scripts/jar.
	* configure.ac (BASH_JAR): Removed conditional.
	(JAR): Prefer the jar found by AC_CHECK_PROGS.

2007-01-29  Tom Tromey  <tromey@redhat.com>

	* Makefile.in: Rebuilt.
	* Makefile.am (interpret.lo): New target.  Add -fwrap to
	AM_CXXFLAGS.

2007-01-29  Keith Seitz  <keiths@redhat.com>

	* include/jvmti_md.h (_CLASSPATH_VM_JVMTI_TYPES_DEFINED):
	Define.
	[__GCJ_JNI_IMPL__]: Define our own JVMTI types when building
	gcj. All jvmti object types now are defined to be their
	corresponding java classes.
	* jvmti.cc (_Jv_JVMTI_SuspendThread): Remove casting from
	jthread to Thread*.
	(_Jv_JVMTI_ResumeThread): Likewise.
	(_Jv_JVMTI_InterruptThread): Likewise.
	(_Jv_JVMTI_SetEventNotificationMode): Likewise.
	* gnu/classpath/jdwp/natVMVirtualMachine.cc
	(jdwpClassPrepareCB): Likewise.
	(jdwpThreadEndCB): Likewise.
	(jdwpThreadStartCB): Likewise.
	(jdwpVMInitCB): Likewise.
 
2007-01-28  Michele Sandri  <gpointorama@gmail.com>

	* gnu/java/nio/channels/natFileChannelWin32.cc
	(lock): Implemented.
	(unlock): Implemented.

2007-01-27  Andreas Tobler  <a.tobler@schweiz.org>

	PR libgcj/30513
	* configure.host: Add forgottten sysdep_dir to sparc. Add a flag to
	libgcj_flags to undefine 'sun' at compile time.
	* sysdep/sparc/locks.h (read_barrier): New functions for 32 and 64 bit
	Sparc.
	(write_barrier): Likewise.

2007-01-27  Keith Seitz  <keiths@redhat.com>

	* gnu/classpath/jdwp/natVMVirtualMachine.cc
	(getAllClassMethods): Move error handling to ...
	(throw_jvmti_error): ... here.
	(jdwpClassPrepareCB): New function.
	(jdwpThreadEndCB): New function.
	(jdwpThreadStartCB): New function.
	(jdwpVMDeathCB): New function.
	(jdwpVMInitCB): Define and enable callbacks for
	ClassPrepare, ThreadEnd, ThreadStart, and VMDeath.

2007-01-27  Jakub Jelinek  <jakub@redhat.com>

	* Makefile.am (generic_header_files): Add $(inner_nat_headers).
	* testsuite/Makefile.am (check-dejaGNU): Depend on compile-tests.
	(MYGCJH): New variable.
	(compile-tests): New goal.
	* Makefile.in: Rebuilt.
	* testsuite/Makefile.in: Rebuilt.

2007-01-26  Andrew Haley  <aph@redhat.com>

	* java/lang/natClass.cc (initializeClass): Re-throw
	SecurityExceptions.
	* java/lang/natVMClassLoader.cc (loadClass): checkPackageAccess.
	* java/lang/ClassLoader.java: (loadClass): Likewise.

2007-01-26  Tom Tromey  <tromey@redhat.com>

	* Updated headers.

2007-01-25  Tom Tromey  <tromey@redhat.com>

	PR libgcj/29594:
	* gnu/gcj/convert/Convert.java (main): Correctly handle missing
	input or output encodings.  Removed unused local variables.

2007-01-25  Keith Seitz  <keiths@redhat.com>

	* include/jvmti-int.h (_Jv_GetJDWP_JVMTIEnv): Declare.
	* gnu/classpath/jdwp/natVMVirtualMachine.cc
	(_Jv_GetJDWP_JVMTIEnv): New function.
	* gnu/classpath/jdwp/natVMMethod.cc (getName): Implement.
	(getSignature): Implement.
	(getModifiers): Implement.

2007-01-25  Andrew Haley  <aph@redhat.com>

	* configure, Makefile.in, include/config.h.in: Rebuilt.
	* Makefile.am (libgcj_la_LIBADD): Removed $(LIBMAGIC).
	* configure.ac: Don't check for libmagic.
	* java/net/natVMURLConnection.cc (p_magic_open, p_magic_load,
	p_magic_close, p_magic_buffer): New globals.
	(init): Look up 'magic' functions.
	(guessContentTypeFromBuffer): Updated.

2007-01-25  Keith Seitz  <keiths@redhat.com>

	* jvmti.cc (_Jv_JVMTI_GetMethodName): New function.
	(_Jv_JVMTI_Interface): Define GetMethodName.
	* testsuite/libjava.jvmti/getmethodname.java: New file.
	* testsuite/libjava.jvmti/natgetmethodname.cc: New file.
	* testsuite/libjava.jvmti/getmethodname.out: New file. 

2007-01-24  Kyle Galloway  <kgallowa@redhat.com>

	* libjava/testsuite/libjava.jvmti/jvmti-interp.exp: New file.
	* libjava/testsuite/libjava.jvmti/interp: New folder.
	* libjava/testsuite/lib/libjava.exp (exec_gij): New Method.

2007-01-24  Keith Seitz  <keiths@redhat.com>

	* link.cc (_Jv_Linker::wait_for_state): Add JVMTI
	CLASS_PREPARE notification.

2007-01-24  Keith Seitz  <keiths@redhat.com>

	* interpret.cc: Include gnu/gcj/jvmti/Breakpoint.h,
	gnu/gcj/jvmti/BreakpointManager.h, jvmti.h, and jvmti-int.h
	* interpret-run.cc: Implement insn_breakpoint.

2007-01-24  Keith Seitz  <keiths@redhat.com>

	* prims.cc (_Jv_RunMain): Send JVMTI event notifications
	for VM_INIT and VM_DEATH instead of the JDWP notifications.

2007-01-24  Keith Seitz  <keiths@redhat.com>

	* gnu/classpath/jdwp/natVMVirtualMachine.cc
	(getAllClassMethods): Implement.

2007-01-24  Andrew Haley  <aph@redhat.com>

	* gnu/classpath/natVMStackWalker.cc: Call InitClass everywhere.
	(getClassContext) Add a barrier to prevent GetStackWalkerStack()
	from being sibcalled.

2007-01-24  Andrew Haley  <aph@redhat.com>

	* scripts/makemake.tcl (emit_bc_rule): Set the source filename.
	* sources.am: Rebuild.

2007-01-24  Andreas Krebbel  <krebbel1@de.ibm.com>

	* exception.cc (parse_lsda_header, PERSONALITY_FUNCTION): Replaced
	_Unwind_Word with _uleb128_t and _Unwind_SWord with _sleb128_t.

2007-01-23  H.J. Lu  <hongjiu.lu@intel.com>

	PR libgcj/30550
	* Makefile.am (ecjx_DEPENDENCIES): Add libgcj_bc.la if needed.
	* Makefile.in: Regenerated.

2007-01-22  Keith Seitz  <keiths@redhat.com>

	* gnu/classpath/jdwp/natVMVirtualMachine.cc
	(getClassMethod): Implement.

2007-01-22  Keith  Seitz  <keiths@redhat.com>

	* java/lang/Class.h (_Jv_GetClassStatus): Declare.
	* java/lang/natClass.cc (_Jv_GetClassStatus): New function.
	* jvmti.cc (_Jv_JVMTI_GetClassStatus): New function.
	(_Jv_JVMTI_Interface): Define GetClassStatus.

2007-01-22  Tom Tromey  <tromey@redhat.com>

	* configure: Rebuilt.
	* configure.ac (GCJ): Reverted patch of 2006-12-20.

2007-01-22  Tom Tromey  <tromey@redhat.com>

	PR java/29812:
	* testsuite/libjava.jni/pr29812.java: New file.
	* testsuite/libjava.jni/pr29812_injar.java: New file.
	* testsuite/libjava.jni/pr29812_injar.jar: New file.
	* testsuite/libjava.jni/pr29812.out: New file.
	* testsuite/libjava.jni/pr29812_injar.c: New file.
	* testsuite/libjava.jni/pr29812_injar.h: New file.
	* testsuite/libjava.jni/pr29812.jar: New file.
	* testsuite/libjava.jni/pr29812.c: New file.
	* testsuite/libjava.jni/pr29812.h: New file.
	* testsuite/libjava.jni/jni.exp (gcj_jni_get_cxxflags_invocation):
	New proc.
	(gcj_jni_invocation_test_one): Use it.
	(gcj_jni_pr29812): New proc.
	(gcj_jni_run): Use it.
	* java/lang/natRuntime.cc (_load): Push a new system frame before
	calling JNI_OnLoad.
	* include/jvm.h (_Jv_JNI_PopSystemFrame): Declare.
	(_Jv_GetJNIEnvNewFrameWithLoader): Likewise.
	* jni.cc (struct _Jv_JNI_LocalFrame) <marker>: Now unsigned char.
	<allocated_p>: Now bool.
	<loader>: New field.
	(_Jv_JNI_EnsureLocalCapacity): Updated.
	(_Jv_JNI_NewLocalRef): Likewise.
	(_Jv_JNI_NewLocalRef): Likewise.
	(_Jv_JNI_PopLocalFrame): Likewise.
	(_Jv_JNI_FindClass): Likewise.
	(_Jv_GetJNIEnvNewFrame): Likewise.
	(_Jv_JNI_AttachCurrentThread): Likewise.
	(_Jv_GetJNIEnvNewFrameWithLoader): New function.
	(_Jv_GetJNIEnvNewFrame): Use it.
	* include/jni_md.h (_CLASSPATH_JNIENV_CONTENTS): Removed 'klass'.

2007-01-22  Tom Tromey  <tromey@redhat.com>

	* libtool-version: Bump current to 9.

2007-01-22  Andrew Haley  <aph@redhat.com>

	* sysdep/alpha/locks.h (write_barrier): New.

2007-01-21  Matthias Klose  <doko@debian.org>

	* Makefile.am (install-exec-hook): Use transformed name.
	* Makefile.in: Regenerate.

2007-01-19  Keith Seitz  <keiths@redhat.com>

	* gnu/classpath/jdwp/natVMVirtualMachine.cc: Mark unused parameters
	in methods and reformat.

	* gnu/classpath/jdwp/natVMFrame.cc: Mark unused parameters with
	MAYBE_UNUSED.

2007-01-18  Keith Seitz  <keiths@redhat.com>

	From Macro Trudel <mtrudel@gmx.ch>:
	* gnu/classpath/jdwp/natVMVirtualMachine.cc (jdwpVMInitCB):
	Use JNICALL.

2007-01-18  Marco Trudel  <mtrudel@gmx.ch>

	* jni.cc (_Jv_JNI_FindClass): Initialize class.
	* testsuite/libjava.jni/findclass2.jar: New file.
	* testsuite/libjava.jni/findclass2.h: New file.
	* testsuite/libjava.jni/findclass2.java: New file
	* testsuite/libjava.jni/findclass2.c: New file.
	* testsuite/libjava.jni/findclass2.out: New file.

2007-01-18  Tom Tromey  <tromey@redhat.com>

	* configure: Rebuilt.
	* configure.ac: Use multi_basedir instead of libgcj_basedir.

2007-01-18  Gary Benson  <gbenson@redhat.com>

	* gnu/java/nio/natVMPipeEcos.cc:
	Renamed from gnu/java/nio/natPipeImplEcos.cc.
	* gnu/java/nio/natVMPipePosix.cc:
	Renamed from gnu/java/nio/natPipeImplPosix.cc.
	* gnu/java/nio/natVMPipeWin32.cc:
	Renamed from gnu/java/nio/natPipeImplWin32.cc.
	* gnu/java/nio/natVMSelectorEcos.cc:
	Renamed from gnu/java/nio/natSelectorImplEcos.cc.
	* gnu/java/nio/natVMSelectorPosix.cc:
	Renamed from gnu/java/nio/natSelectorImplPosix.cc.
	* gnu/java/nio/natVMSelectorWin32.cc:
	Renamed from gnu/java/nio/natSelectorImplWin32.cc.
	* java/io/natVMObjectInputStream.cc:
	Renamed from java/io/natObjectInputStream.cc.
	* java/lang/natVMDouble.cc:
	Renamed from java/lang/natDouble.cc.
	* java/lang/natVMFloat.cc:
	Renamed from java/lang/natFloat.cc.	
	* Makefile.am, configure.ac: Reflect the above.
	* Makefile.in, configure: Rebuilt.

2007-01-17  Andrew Haley  <aph@redhat.com>

	* Makefile.in: Rebuilt.
	* Makefile.am (ecjx_LDFLAGS): Pass -fbootclasspath.

2007-01-17  Keith Seitz  <keiths@redhat.com>

	* java/lang/natThread.cc (finish_): Add JVMTI ThreadEnd notification.
	(_Jv_NotifyThreadStart): Add JVMTI ThreadStart notification.

2007-01-16  Jack Howarth  <howarth@bromo.med.uc.edu>

	* configure.ac: Use multi.m4 from aclocal rather than custom
	code.  Use multi_basedir instead libgcj_basedir.  Test for
	/proc/self/exe when not cross-compiling.
	* aclocal.m4: Regenerate.
	* configure: Regenerate.
	* Makefile.in: Regenerate.

2007-01-17  Gary Benson  <gbenson@redhat.com>

	* java/nio/natVMDirectByteBufferImpl.cc:
	Renamed from java/nio/natDirectByteBufferImpl.cc.
	* Makefile.am: Reflect the above.
	* Makefile.in: Rebuilt.
	
2007-01-17  Marco Trudel  <mtrudel@gmx.ch>

	* jvmti.cc (_Jv_JVMTI_GetAllThreads): Now static.  Use JNICALL.
	Fixed indentation.  Removed unused variable.

2007-01-16  Tom Tromey  <tromey@redhat.com>

	* java/lang/natThread.cc (finalize_native): Remove cast.
	(_Jv_GetCurrentJNIEnv): Likewise.
	* include/jvm.h (struct natThread) <jni_env>: Declare as
	_Jv_JNIEnv*.

2007-01-16  Keith Seitz  <keiths@redhat.com>

	* testsuite/libjava.jvmti/natevents.cc (FieldModificationCB): Use
	%#llx instead of %d for new_value.
	* testsuite/libjava.jvmti/events.out: Update expected output.
	* testsuite/libjava.jvmti/events.jar: Regenerate.

2007-01-16  Keith Seitz  <keiths@redhat.com>

	* gnu/classpath/jdwp/natVMVirtualMachine.cc (DEFINE_CALLBACK):
	New macro.
	(ENABLE_EVENT): New macro.
	(initialize): Define and enable JVMTI VM_INIT callback.
	(jdwpVMInitCB): New function.

2007-01-16  Kyle Galloway  <kgallowa@redhat.com>

	* jvmti.cc (_Jv_JVMTI_GetAllThreads): New function.
	* testsuite/libjava.jvmti/getallthreads.java: New test.
	* testsuite/libjava.jvmti/natgetallthreads.cc: Ditto.
	* testsuite/libjava.jvmti/getallthreads.out: Ditto.
	* testsuite/libjava.jvmti/getallthreads.h: Ditto.
	* testsuite/libjava.jvmti/getallthreads.jar: Ditto. 

2007-01-15  Keith Seitz  <keiths@redhat.com>

	* gnu/classpath/jdwp/natVMVirtualMachine.cc (suspendThread): Use
	java.lang.StringBuilder instead of java.lang.StringBuffer.
	(resumeThread): Likewise.

2007-01-15  Gary Benson  <gbenson@redhat.com>

	* java/nio/MappedByteBuffer.java: Removed.
	* sources.am, Makefile.in: Rebuilt.

2007-01-15  Gary Benson  <gbenson@redhat.com>

	* java/net/URLClassLoader.java: Removed.
	* gnu/java/net/loader/Load_gcjlib.java: New file.
	* gnu/gcj/runtime/BootClassLoader.java: Ensure core
	URL handler is present in static executables.
	* sources.am, Makefile.in: Rebuilt.

2007-01-14  H.J. Lu  <hongjiu.lu@intel.com>

	* Makefile.am (libgcj_la_LDFLAGS): Add
	$(LIBGCJ_LD_SYMBOLIC_FUNCTIONS).
	(libgcj_tools_la_LDFLAGS): Likewise.
	(libgcj_bc_la_LDFLAGS): Likewise.
	* Makefile.in: Regenerated.

	* configure.ac: Use ACX_PROG_LD_GNU_SYMBOLIC.  Set
	LIBGCJ_LD_SYMBOLIC_FUNCTIONS to $SYMBOLIC_LDFLAGS.  Set
	libgcj_ld_symbolic to $SYMBOLIC_LDFLAGS if it isn't set.
	Substitute LIBGCJ_LD_SYMBOLIC_FUNCTIONS.
	* configure: Regenerated.
	* aclocal.m4: Likewise.
	* gcj/Makefile.in: Likewise.
	* include/Makefile.in: Likewise.
	* testsuite/Makefile.in: Likewise.

2007-01-12  Kaz Kojima  <kkojima@gcc.gnu.org>

	* sysdep/sh/locks.h (read_barrier): New.
	(write_barrier): Likewise.

2007-01-12  Andrew Haley  <aph@redhat.com>

	* include/i386-signal.h: Rewrite to use rt_sigaction.

2007-01-11  Andrew Haley  <aph@redhat.com>

	* prims.cc (jdwpOptions) Fix deprecated cast from char[] constant
	to char*.
	* include/x86_64-signal.h (HANDLE_DIVIDE_OVERFLOW): Rewrite to fix
	aliasing violation.

2007-01-10  Tom Tromey  <tromey@redhat.com>

	* gnu/gcj/xlib/*.h: New files.
	* gnu/awt/xlib/*.h: Likewise.
	* classpath/lib/gnu/gcj/xlib: New class files.
	* classpath/lib/gnu/awt/xlib: Likewise.

2007-01-10  Tom Tromey  <tromey@redhat.com>

	* HACKING: Various updates.

2007-01-10  Tom Tromey  <tromey@redhat.com>

	* java/lang/natDouble.cc (toString): Added parens.
	* gnu/gcj/io/shs.h (PROTO): Define.
	* link.cc (resolve_pool_entry): Added missing braces.

2007-01-10  H.J. Lu  <hongjiu.lu@intel.com>

	PR libgcj/30424
	* sysdep/ia64/locks.h (read_barrier): New.
	(write_barrier): New.

2007-01-10  Gary Benson  <gbenson@redhat.com>

	* java/net/URL.java: Removed.
	* sources.am, Makefile.in: Rebuilt.

2007-01-10  Matthias Klose  <doko@debian.org>

	* Makefile.am (install-exec-hook): Support $(DESTDIR).
	* Makefile.in: Regenerated.

2007-01-05  Tom Tromey  <tromey@redhat.com>

	* testsuite/libjava.loader/loader.exp (gcj_loader_run): Find
	dummy.class in srcdir.

2007-01-03  Tom Tromey  <tromey@redhat.com>

	* testsuite/libjava.cni/cni.exp (gcj_cni_compile_cxx_to_o): Add -I
	for srcdir.

2007-01-03  Tom Tromey  <tromey@redhat.com>

	* testsuite/*: Added many .jar and .h files.
	* testsuite/libjava.special/special.exp
	(gcj_special_try_compiler): New proc.
	* testsuite/libjava.loader/loader.exp (gcj_loader_run): Don't
	bytecompile source.  Search for .jar files.
	(gcj_loader_test_one): Don't look for MyLoader.java.
	* testsuite/libjava.jvmti/jvmti.exp (gcj_jvmti_test_one): Don't
	bytecompile sources or build headers.
	(gcj_jvmti_run): Look for .jar files.
	* testsuite/libjava.jni/jni.exp (gcj_jni_run): Compile .jar
	files.
	(gcj_jni_test_one): Don't bytecompile sources or build headers.
	Set classpath when invoking gij.
	(gcj_jni_invocation_test_one): Likewise.
	* testsuite/libjava.cni/cni.exp (gcj_cni_test_one): Don't build
	headers or bytecompile sources.
	(gcj_cni_run): Use .jar files, not .java files.
	* testsuite/libjava.lang/lang.exp: Compile .jar files.

2007-01-02  Tom Tromey  <tromey@redhat.com>

	* configure: Rebuilt.
	* configure.ac: Check for gjar.

2007-01-02  Tom Tromey  <tromey@redhat.com>

	* testsuite/libjava.jacks/jacks.exp: Removed.
	* testsuite/libjava.jacks/jacks.xfail: Removed.

